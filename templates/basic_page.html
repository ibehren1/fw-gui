<html>

<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

<!-- Local CSS -->
<link rel="stylesheet" href="static/styles.css" type="text/css">

<header>
    <h1>VyOS Firewall Rule Configuration Generator</h1>

    {% if current_user.is_authenticated %}
    <table align="right">
        <td align="right">
            <a href="{{ url_for('logout')}}">
                <input type="submit" value="Logout" style="width: 100%">
            </a>
        </td>
    </table>
    {% endif %}


</header>

<body class="page_background">


    <table border="0" align="center" style="vertical-align: top;">
        <tr>
            <td width="25%" style="vertical-align: top;">
                {% if current_user.is_authenticated %}
                <table border="0">
                    <colgroup>
                        <col span="1" style="width: 50%;">
                        <col span="1" style="width: 50%;">
                    </colgroup>
                    <td align="center">
                        <p class="section_heading">Firewall Configs</p>
                        Click config name below to view config.
                        <br>
                        <br>
                    </td>
                    {% if file_list%}
                    {% for file in file_list %}
                    <form action="/select_firewall_config" method=post>
                        <tr>
                            <td align="center">
                                <input type="radio" name="action" value="{{file}}">{{file}}<br>
                            </td>
                        </tr>
                        {% endfor %}
                        <tr>
                            <td align="center">
                                <input class="button" type="submit" value="Select Config" style="width: 100%">
                            </td>
                        </tr>
                    </form>
                    {% endif %}
                    <tr>
                        <td>
                            <br>
                            <br>
                            <br>
                            <form action="/upload_json" method=post enctype=multipart/form-data>
                                <input type="file" name="file">
                                <input class="button" type="submit" style="width: 100%;" value="Upload Datafile">
                            </form>
                        </td>
                    </tr>
                </table>
                {% endif %}
            </td>
            <td width="50%">
                {% block body %}
                {% endblock body %}
            </td>
            <td width="25%" style="vertical-align: top;">

                <table align="right" border="0">
                    <colgroup>
                        <col span="1" style="width: 50%;">
                        <col span="1" style="width: 50%;">
                    </colgroup>
                    <tr align="center">
                        <td text-align="center" colspan="2">
                            {% with flashed_messages = get_flashed_messages(with_categories=true) %}
                            {% if flashed_messages %}
                            {% for category, flash_message in flashed_messages %}
                            <div class="alert alert-{{ category }}">
                                {{flash_message}}
                            </div>
                            {% endfor %}
                            {% endif %}
                            {% endwith %}
                        </td>
                    </tr>
                    {% if firewall_name %}
                    <tr align="center">
                        <td text-align="center" colspan="2">
                            <p class="section_heading">
                                <b>Firewall Name:</b>
                                <font size="+2">{{ firewall_name }}</font>
                            </p>
                            </style>
                        </td>
                    </tr>
                    <tr>
                        <td align="center" colspan="2">
                            <br> <br>
                            <p class="section_heading">
                                Configuration
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <a href="{{ url_for('display_config')}}">
                                <input class="button" type="submit" value="Display Configuration" style="width: 100%">
                            </a>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <a href="{{url_for('download_config')}}" download="{{firewall_name}}.cfg">
                                <input class="button" type="submit" style="width: 100%;" value="Download Configuration">
                            </a>
                        </td>
                    </tr>
                    <tr>
                        <td align="center" colspan="2">
                            <br> <br>
                            <p class="section_heading">
                                Groups
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <a href="{{ url_for('add_group_form')}}">
                                <input class="button" type="submit" value="Add Group" style="width: 100%">
                            </a>
                        </td>
                        <td>
                            <a href="{{ url_for('delete_group_form')}}">
                                <input class="button" type="submit" value="Delete Group" style="width: 100%">
                            </a>
                        </td>
                    </tr>
                    <tr>
                        <td align="center" colspan="2">
                            <br> <br>
                            <p class="section_heading">
                                Tables
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <a href="{{ url_for('add_table_form')}}">
                                <input class="button" type="submit" value="Add Table" style="width: 100%">
                            </a>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <a href="{{ url_for('add_rule_form')}}">
                                <input class="button" type="submit" value="Add Rule" style="width: 100%">
                            </a>
                        </td>
                        <td>
                            <a href="{{ url_for('delete_rule_form')}}">
                                <input class="button" type="submit" value="Delete Rule" style="width: 100%">
                            </a>
                        </td>
                    </tr>
                    <tr>
                        <td align="center" colspan="2">
                            <br> <br>
                            <p class="section_heading">
                                Filters
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <a href="{{ url_for('add_filter_form')}}">
                                <input class="button" type="submit" value="Add Filter" style="width: 100%">
                            </a>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <a href="{{ url_for('add_filter_rule_form')}}">
                                <input class="button" type="submit" value="Add Rule" style="width: 100%">
                            </a>
                        </td>
                        <td>
                            <a href="{{ url_for('delete_filter_rule_form')}}">
                                <input class="button" type="submit" value="Delete Rule" style="width: 100%">
                            </a>
                        </td>
                    </tr>
                    <tr>
                        <td align="center" colspan="2">
                            <br> <br>
                            <p class="section_heading">
                                Export Datafile
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <a href="{{url_for('download_json')}}" download="{{firewall_name}}.json">
                                <input class="button" type="submit" value="Download Datafile">
                            </a>
                        </td>
                    </tr>
                    {% endif %}
                </table>
            </td>
        </tr>
    </table>

</body>

<footer>
    <p>vyos-fw-gui v0.5.0</p>
    <p>Copyright 2024 Isaac Behrens</p>
</footer>

</html>